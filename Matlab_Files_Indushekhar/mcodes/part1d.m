%part 1D Linearized response to initial condition x_0%

m1=100;
m2=100;
M = 1000;
g = 9.8;
l1 =20;
l2 =10; 

A= [0 1 0 0 0 0 ; 0 0 -(m1*g/M) 0 -(m2*g/M) 0 ; 0 0 0 1 0 0 ; 0 0 -(g*(M+m1))/(M*l1) 0 -(m2*g)/(M*l1) 0 ;0 0 0 0 0 1; 0 0 -(m1*g)/(M*l2) 0 -(g*(M+m2))/(M*l2) 0]
B= [ 0; 1/M ;0; 1/(M*l1) ;0 ;1/(M*l2)];
C=[1 0 0 0 0 0;0 1 0 0 0 0;0 0 1 0 0 0; 0 0 0 0 1 0 ]
D=[0]
x_0= [ 5 ; 0; 0.1 ;  0 ; 0.2; 0]
Q=[1 0 0 0 0 0;0 1 0 0 0 0; 0 0 100 0 0 0; 0 0 0 1000 0 0; 0 0 0 0 150 0; 0 0 0 0 0 1500]
R=0.0001
K=lqr(A,B,Q,R)
eig(A-B*K)
sys=ss(A-B*K,B,C,D)
initial(sys,x_0)
grid



